# DiAGAN
3D simulations of earth textures using generative adversarial networks and 2D examples

## How to use

## Scripts

#### train.py

This script allow you to train a GAN.

optional arguments:
```
  -dx DX
        Training image orthogonal to X axis
  -dy DY
        Training image orthogonal to Y axis
  -dz DZ
        Training image orthogonal to Z axis (optionnal)

  -dataset DATASET [DATASET ...]
        3D training image from which are taken triplets of cuts. If a list of file is provided, TI are sampled uniformly from all the files.

  -checkpoint-freq CHECKPOINT_FREQ
        Number of training epochs between model checkpoint. 0 means no checkpoints. Default is 1.

  -name NAME, --name NAME
        Name of the final model.

  --n-generated N_GENERATED
        Number of samples generated at each epochs
  
  -fid, --fid 
        If set, computes the Frechet Inception Distance after each
        training epochs, and outputs it in a log file
  
  -binarize, --binarize
        If set, output images are binarizes into black & white.

  --lr LR
        Optimizer's learning rate. Default is 1e-3

  --batch-size BATCH_SIZE
        Batch size. Default is 10
  
  --epoch-size EPOCH_SIZE
        Number of iterations that form an epoch. Default is 1000

  --epochs EPOCHS
        Total number of epochs.

  --lmbd LMBD
        gradient penalty weight
  
  --n-critic N_CRITIC
        Number of critic iterations per generator iteration. Default is 5.
  
  --seed SEED
        random seed to set for reproducibility
```

Models and output images will be saved in the __output__ subfolder.
If it does not exist, this subfolder will be created. Models have extension .model

#### generate.py

The `generate.py` file is meant to initialize a GAN from a model file (so, a GAN that has already been trained), and use its generator to create images.

Usage:
```
usage: generate.py [-h] -model MODEL [-n N] [-name NAME] [-binarize]
```

Optional arguments:
```
  -model MODEL, --model MODEL
       Path to the trained model. Should be a serialized model from the train.py script (.model extension) 
 
  -n N, --n N
        Number of samples to generate

  -name NAME, --name NAME
        Name of the sample. They will be saved as <name>_i.png 

  -binarize, --binarize
        Binarization thresholding argument. If this argument is present, the values will be binarized to black & white. Useful for two facies outputs.
```

Output images will be saved in the __output__ folder.


#### stats_torch.py


Utility files used for generating the analysis graphs of the paper, including connectivity and variograms.

optional arguments:
  -fun FUN, --fun FUN
        The function to be called : 'conn' for connectivity, 'var' for variogram
  
  -model MODEL, --model MODEL
        The trained model used for generating samples. Be careful to use a serialized model from the tensorflow code (with extension .genmodel)
  
  -ti TI, --ti TI
        The training image

  -output OUTPUT, --output OUTPUT

  -n-samples N_SAMPLES, --n-samples N_SAMPLES
    number of samples generated by the model.

  -n-ti N_TI, --n-ti N_TI
    number of samples generated from the TI